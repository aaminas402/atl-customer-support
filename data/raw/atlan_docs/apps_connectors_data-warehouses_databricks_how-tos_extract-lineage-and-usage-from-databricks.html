<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-apps/connectors/data-warehouses/databricks/how-tos/extract-lineage-and-usage-from-databricks" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">extract lineage and usage from Databricks | Atlan Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.atlan.com/apps/connectors/data-warehouses/databricks/how-tos/extract-lineage-and-usage-from-databricks"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="extract lineage and usage from Databricks | Atlan Documentation"><meta data-rh="true" name="description" content="Once you have [crawled assets from Databricks](/apps/connectors/data-warehouses/databricks/how-tos/crawl-databricks), you can retrieve lineage from [Unity Catalog](https://docs.databricks.com/data-governance/unity-catalog/index.html) and [usage and popularity metrics](/product/capabilities/usage-and-popularity/how-tos/interpret-usage-metrics) from [query history](https://docs.databricks.com/api/workspace/queryhistory/list) or system tables. This is supported for all [three authentication methods](/apps/connectors/data-warehouses/databricks/how-tos/set-up-databricks): personal access token, AWS service principal, and Azure service principal."><meta data-rh="true" property="og:description" content="Once you have [crawled assets from Databricks](/apps/connectors/data-warehouses/databricks/how-tos/crawl-databricks), you can retrieve lineage from [Unity Catalog](https://docs.databricks.com/data-governance/unity-catalog/index.html) and [usage and popularity metrics](/product/capabilities/usage-and-popularity/how-tos/interpret-usage-metrics) from [query history](https://docs.databricks.com/api/workspace/queryhistory/list) or system tables. This is supported for all [three authentication methods](/apps/connectors/data-warehouses/databricks/how-tos/set-up-databricks): personal access token, AWS service principal, and Azure service principal."><link data-rh="true" rel="icon" href="/img/atlan.ico"><link data-rh="true" rel="canonical" href="https://docs.atlan.com/apps/connectors/data-warehouses/databricks/how-tos/extract-lineage-and-usage-from-databricks"><link data-rh="true" rel="alternate" href="https://docs.atlan.com/apps/connectors/data-warehouses/databricks/how-tos/extract-lineage-and-usage-from-databricks" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.atlan.com/apps/connectors/data-warehouses/databricks/how-tos/extract-lineage-and-usage-from-databricks" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://N7XGBZ1DRU-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Databricks","item":"https://docs.atlan.com/apps/connectors/data-warehouses/databricks/"},{"@type":"ListItem","position":2,"name":"How to extract lineage and usage from Databricks","item":"https://docs.atlan.com/apps/connectors/data-warehouses/databricks/how-tos/extract-lineage-and-usage-from-databricks"}]}</script><link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-TZTFMW4J",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>



<link rel="search" type="application/opensearchdescription+xml" title="Atlan Documentation" href="/opensearch.xml">
<script>window.chatbaseConfig={chatbotId:"btNPYbU8VGvFO0WWx3RKy"}</script>
<script src="https://darkvisitors.com/tracker.js?project_key=d507548f-a6ca-4d07-a911-d7ba35b9fec1"></script>
<script src="/scripts/atlan-scout.js" defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.2ae6c2ab.css">
<script src="/assets/js/runtime~main.0b8b8442.js" defer="defer"></script>
<script src="/assets/js/main.8984a2fd.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TZTFMW4J" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/atlan-logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top customNavbar_Xl4v"><div class="topRow_xtvp"><div class="leftSection_J1NA"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/atlan-logo.svg" alt="Atlan Logo" class="themedComponent_mlkZ themedComponent--light_NVdE" height="52" width="52"><img src="/img/atlan-logo.svg" alt="Atlan Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="52" width="52"></div><b class="navbar__title text--truncate"></b></a></div><div class="centerSection_aleN"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="rightSection_NZiV"><a href="https://docs.google.com/forms/d/e/1FAIpQLScuAIhCm2GS7YFstrOjawbP8J7PUmOynQo7wI2yGCcCyEcVSw/viewform" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Partner with us<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://shipped.atlan.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">What&#x27;s new<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://atlan.zendesk.com/auth/v2/login/signin?return_to=https%3A%2F%2Fatlan.zendesk.com%2Fhc%2Fen-us&amp;theme=hc&amp;locale=en-us&amp;brand_id=1900000425113&amp;auth_origin=1900000425113%2Cfalse%2Ctrue" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support portal<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="signInButton_ixSd"><a class="navbar__item navbar__link" href="/support/submit-request">Contact support</a></div><button class="clean-btn mobileMenuButton_ad49" aria-label="Toggle navigation bar"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button></div></div><div class="menuRow_gXbp"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__item navbar__link" href="/get-started/what-is-atlan">Get started</a><div class="navbar__item dropdown nestedDropdownRoot_TGVd"><a href="#" role="button" tabindex="0" class="navbar__link nestedDropdownLink_AhWE" aria-haspopup="true" aria-expanded="false">Connect data<span class="nestedDropdownCaret_oaQx"></span></a></div><div class="navbar__item dropdown nestedDropdownRoot_TGVd"><a href="#" role="button" tabindex="0" class="navbar__link nestedDropdownLink_AhWE" aria-haspopup="true" aria-expanded="false">Use data<span class="nestedDropdownCaret_oaQx"></span></a></div><div class="navbar__item dropdown nestedDropdownRoot_TGVd"><a href="#" role="button" tabindex="0" class="navbar__link nestedDropdownLink_AhWE" aria-haspopup="true" aria-expanded="false">Build governance<span class="nestedDropdownCaret_oaQx"></span></a></div><div class="navbar__item dropdown nestedDropdownRoot_TGVd"><a href="#" role="button" tabindex="0" class="navbar__link nestedDropdownLink_AhWE" aria-haspopup="true" aria-expanded="false">Configure Atlan<span class="nestedDropdownCaret_oaQx"></span></a></div></div><div class="navbar__items navbar__items--right"></div></div></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/apps/connectors/data-warehouses/databricks">Databricks</a><button aria-label="Collapse sidebar category &#x27;Databricks&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/apps/connectors/data-warehouses/databricks/how-tos/set-up-databricks">Get Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/apps/connectors/data-warehouses/databricks/how-tos/set-up-cross-workspace-extraction">Cross-workspace Setup</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/apps/connectors/data-warehouses/databricks/how-tos/crawl-databricks">Crawl Databricks Assets</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/apps/connectors/data-warehouses/databricks/how-tos/set-up-on-premises-databricks-access">On-premises Setup</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/apps/connectors/data-warehouses/databricks/how-tos/set-up-an-aws-private-network-link-to-databricks">Private Network Setup</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/apps/connectors/data-warehouses/databricks/how-tos/extract-lineage-and-usage-from-databricks">Lineage and Usage</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/apps/connectors/data-warehouses/databricks/how-tos/extract-lineage-and-usage-from-databricks">How to extract lineage and usage from Databricks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/apps/connectors/data-warehouses/databricks/how-tos/extract-on-premises-databricks-lineage">How to extract on-premises Databricks lineage</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/apps/connectors/data-warehouses/databricks/how-tos/manage-databricks-tags">Tag management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/apps/connectors/data-warehouses/databricks/references/what-does-atlan-crawl-from-databricks">References</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/apps/connectors/data-warehouses/databricks/troubleshooting/troubleshooting-databricks-connectivity">Troubleshooting</a></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Alpn" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_xK9p"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Connect data</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Data Warehouses</span></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/apps/connectors/data-warehouses/databricks"><span>Databricks</span></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Lineage and Usage</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">How to extract lineage and usage from Databricks</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>extract lineage and usage from Databricks</h1></header><p>Once you have <a href="/apps/connectors/data-warehouses/databricks/how-tos/crawl-databricks">crawled assets from Databricks</a>, you can retrieve lineage from <a href="https://docs.databricks.com/data-governance/unity-catalog/index.html" target="_blank" rel="noopener noreferrer">Unity Catalog</a> and <a href="/product/capabilities/usage-and-popularity/how-tos/interpret-usage-metrics">usage and popularity metrics</a> from <a href="https://docs.databricks.com/api/workspace/queryhistory/list" target="_blank" rel="noopener noreferrer">query history</a> or system tables. This is supported for all <a href="/apps/connectors/data-warehouses/databricks/how-tos/set-up-databricks">three authentication methods</a>: personal access token, AWS service principal, and Azure service principal.</p>
<p>Both Atlan and Databricks strongly recommend using the system tables method to extract <a href="#configure-the-lineage-extractor">lineage</a> and <a href="#optional-configure-the-usage-extractor">usage and popularity metrics</a> from Databricks.</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><p><a href="/product/capabilities/usage-and-popularity/how-tos/interpret-usage-metrics">Usage and popularity metrics</a> can be retrieved for all Databricks users. However, your Databricks workspace must be <a href="https://docs.databricks.com/data-governance/unity-catalog/get-started.html" target="_blank" rel="noopener noreferrer">Unity Catalog-enabled</a> for the retrieval of lineage and usage and popularity metrics to succeed. You may also need to <a href="https://docs.databricks.com/data-governance/unity-catalog/migrate.html" target="_blank" rel="noopener noreferrer">upgrade existing tables and views to Unity Catalog</a>, as well as reach out to your Databricks account executive to enable lineage in Unity Catalog. (As of publishing, the feature is still in preview from Databricks on AWS and Azure.)</p></div></div>
<p>To retrieve lineage and usage from Databricks, rev</p>
<div style="position:relative;padding-bottom:calc(66.33333333333333% + 41px);height:0;width:100%"><iframe src="https://demo.arcade.software/rOE5UNrknGw7mITcKdWD?embed" style="position:absolute;top:0;left:0;width:100%;height:100%;color-scheme:light" title="Extract Databricks lineage and usage" frameborder="0"></iframe></div>
<p>iew the <a href="/product/connections/how-tos/order-workflows">order of operations</a> and then complete the following steps.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="select-the-extractor">Select the extractor<a href="#select-the-extractor" class="hash-link" aria-label="Direct link to Select the extractor" title="Direct link to Select the extractor">â</a></h2>
<p>To select the Databricks lineage and usage extractor:</p>
<ol>
<li>In the top right of any screen, navigate toÂ <strong>New</strong> and then clickÂ <strong>New Workflow</strong>.</li>
<li>From the filters along the top, click <strong>Miner</strong>.</li>
<li>From the list of packages, select <strong>Databricks Miner</strong> and click on <strong>Setup Workflow</strong>.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configure-the-lineage-extractor">Configure the lineage extractor<a href="#configure-the-lineage-extractor" class="hash-link" aria-label="Direct link to Configure the lineage extractor" title="Direct link to Configure the lineage extractor">â</a></h2>
<p>Choose your lineage extraction method:</p>
<ul>
<li>In <strong>REST API</strong>, Atlan connects to your database and extracts lineage directly.</li>
<li>In <strong>Offline</strong>, you will need to first <a href="/apps/connectors/data-warehouses/databricks/how-tos/set-up-on-premises-databricks-lineage-extraction">extract lineage yourself</a> and <a href="/apps/connectors/data-warehouses/databricks/how-tos/extract-on-premises-databricks-lineage">make it available in S3</a>.</li>
<li>In <strong>System Table</strong>, Atlan connects to your database and <a href="/apps/connectors/data-warehouses/databricks/how-tos/set-up-databricks">queries system tables</a> to extract lineage directly.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rest-api">REST API<a href="#rest-api" class="hash-link" aria-label="Direct link to REST API" title="Direct link to REST API">â</a></h3>
<p>To configure the Databricks lineage extractor:</p>
<ol>
<li>For <em>Connection</em>, select the connection to extract. (To select a connection, <a href="/apps/connectors/data-warehouses/databricks/how-tos/crawl-databricks">the crawler</a> must have already run.)</li>
<li>Click <strong>Next</strong> to proceed.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="offline-extraction-method">Offline extraction method<a href="#offline-extraction-method" class="hash-link" aria-label="Direct link to Offline extraction method" title="Direct link to Offline extraction method">â</a></h3>
<p>Atlan supports the <a href="/apps/connectors/data-warehouses/databricks/how-tos/set-up-on-premises-databricks-lineage-extraction">offline extraction method</a> for extracting lineage from Databricks This method uses Atlan&#x27;s databricks-extractor tool to extract lineage. You will need to first <a href="/apps/connectors/data-warehouses/databricks/how-tos/set-up-on-premises-databricks-lineage-extraction">extract lineage yourself</a> and <a href="/apps/connectors/data-warehouses/databricks/how-tos/extract-on-premises-databricks-lineage">make it available in S3</a>.</p>
<p>To enter your S3 details:</p>
<ol>
<li>For <em>Connection</em>, select the connection to extract. (To select a connection, <a href="/apps/connectors/data-warehouses/databricks/how-tos/crawl-databricks">the crawler</a> must have already run.)</li>
<li>For <em>Bucket name</em>, enter the name of your S3 bucket.</li>
<li>For <em>Bucket prefix</em>, enter the S3 prefix under which all the metadata files exist. These include <code>extracted-lineage/result-0.json</code>, <code>extracted-query-history/result-0.json</code>, and so on.</li>
<li>For <em>Bucket region</em>, enter the name of the S3 region.</li>
<li>When complete, at the bottom of the screen, click <strong>Next</strong>.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="system-table">System table<a href="#system-table" class="hash-link" aria-label="Direct link to System table" title="Direct link to System table">â</a></h3>
<p>To configure the Databricks lineage extractor:</p>
<ol>
<li>For <em>Connection</em>, select the connection to extract. (To select a connection, <a href="/apps/connectors/data-warehouses/databricks/how-tos/crawl-databricks">the crawler</a> must have already run.)</li>
<li>*<strong>Extraction Catalog Type</strong>:<!-- -->
<ul>
<li>
<p><strong>Default</strong>: Select to fetch lineage from the system catalog and <code>access</code> schema.</p>
</li>
<li>
<p><strong>Cloned_catalog</strong>: Select to fetch lineage from a cloned catalog and schema.<br>
<!-- -->Before proceeding, make sure the following prerequisites are met:</p>
<ul>
<li>You have already created cloned views named <code>column_lineage</code> and <code>table_lineage</code> in your schema.<br>
<!-- -->If not, follow the steps in <a href="/apps/connectors/data-warehouses/databricks/how-tos/set-up-databricks#optional-create-cloned-views-of-system-tables">Create cloned views of system tables</a>.</li>
<li>The <code>atlan-user</code> must have <code>SELECT</code> permissions on both views to access lineage data.</li>
</ul>
<p>Then, provide values for the following fields:</p>
<ul>
<li><strong>Cloned Catalog Name</strong> â Catalog containing the cloned views.</li>
<li><strong>Cloned Schema Name</strong> â Schema containing the cloned views.</li>
</ul>
</li>
</ul>
</li>
<li>For <em>SQL Warehouse ID</em>, enter the <a href="/apps/connectors/data-warehouses/databricks/how-tos/set-up-databricks">ID you copied from your SQL warehouse</a>.</li>
<li>Click <strong>Next</strong> to proceed.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="optional-configure-the-usage-extractor">(Optional) Configure the usage extractor<a href="#optional-configure-the-usage-extractor" class="hash-link" aria-label="Direct link to (Optional) Configure the usage extractor" title="Direct link to (Optional) Configure the usage extractor">â</a></h2>
<p>Atlan extracts <a href="/product/capabilities/usage-and-popularity/how-tos/interpret-usage-metrics">usage and popularity metrics</a> from:</p>
<ul>
<li><a href="https://docs.databricks.com/api/workspace/queryhistory/list" target="_blank" rel="noopener noreferrer">Query history</a></li>
<li><a href="https://docs.databricks.com/en/admin/system-tables/index.html#grant-access-to-system-tables" target="_blank" rel="noopener noreferrer">System tables</a></li>
</ul>
<p>This feature is currently limited to queries on SQL warehouses   -  queries on interactive clusters are not supported. Additionally, expensive queries and compute costs for Databricks assets are currently unavailable due to limitations of the <a href="https://docs.databricks.com/api/workspace/queryhistory/list" target="_blank" rel="noopener noreferrer">Databricks APIs</a>.</p>
<p>To configure the Databricks usage and popularity extractor:</p>
<ol>
<li>For <em>Fetch Query History and Calculate Popularity</em>, click <strong>Yes</strong> to retrieve <a href="/product/capabilities/usage-and-popularity/how-tos/interpret-usage-metrics">usage and popularity metrics</a> for your Databricks assets.</li>
<li>For <em>Popularity Extraction Method</em>: Choose one of the following methods to extract usage and popularity metrics::<!-- -->
<ul>
<li>Click <strong>REST API</strong> to extract usage and popularity metrics from query history.</li>
<li>Click <strong>System table</strong> to extract metrics directly from system tables:<!-- -->
<ul>
<li>
<p><strong>Extraction catalog type for popularity</strong>: Choose where to fetch popularity data from:</p>
<ul>
<li><strong>Default</strong>: Uses the system catalog and <code>query</code> schema to fetch popularity metrics.</li>
<li><strong>Cloned_catalog</strong>: Select to fetch popularity from cloned views in a separate catalog and schema.<br>
<!-- -->Before proceeding:</li>
<li>The <code>query_history</code> view must exist in the provided schema.</li>
<li>The <code>atlan-user</code> must have <code>SELECT</code> permission on the view.</li>
</ul>
<p>Then provide:</p>
<ul>
<li><strong>Cloned Catalog Name</strong> â The catalog that contains the <code>query_history</code> view.</li>
<li><strong>Cloned Schema Name</strong> â The schema that contains the <code>query_history</code> view.</li>
</ul>
<p>For more information, see <a href="/apps/connectors/data-warehouses/databricks/how-tos/set-up-databricks#optional-create-cloned-views-of-system-tables">Create cloned views of system tables</a>.</p>
</li>
<li>
<p>For <em>SQL Warehouse ID</em>, enter the <a href="/apps/connectors/data-warehouses/databricks/how-tos/set-up-databricks">ID you copied from your SQL warehouse</a>.</p>
</li>
</ul>
</li>
</ul>
</li>
<li>Configure the usage extractor: Â Â <!-- -->
<ul>
<li>For <em>Popularity Window (days)</em>, 30 days is the maximum limit. You can set a shorter popularity window of less than 30 days.</li>
<li>For <em>Start time</em>, choose the earliest date from which to mine query history. If you&#x27;re using the <a href="#offline-extraction-method">offline extraction method</a> to extract query history from Databricks, skip to the next step.</li>
<li>For <em>Excluded Users</em>, type the names of users to be excluded while calculating <a href="/product/capabilities/usage-and-popularity/how-tos/interpret-usage-metrics">usage metrics</a> for Databricks assets. Press <code>enter</code> after each name to add more names.Â </li>
</ul>
</li>
</ol>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><p>If running the miner for the first time, Atlan recommends setting a start date around three days prior to the current date and then scheduling it daily to build up to two weeks of query history. Mining two weeks of query history on the first miner run may cause delays. For all subsequent runs, Atlan requires a minimum lag of 24 to 48 hours to capture all the relevant transformations that were part of a session. Learn more about the miner logic <a href="/product/capabilities/usage-and-popularity/troubleshooting/troubleshooting-usage-and-popularity-metrics">here</a>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="run-the-extractor">Run the extractor<a href="#run-the-extractor" class="hash-link" aria-label="Direct link to Run the extractor" title="Direct link to Run the extractor">â</a></h2>
<p>To run the Databricks lineage and popularity extractor, after completing the steps above:</p>
<ol>
<li>To check for any <a href="/apps/connectors/data-warehouses/databricks/references/preflight-checks-for-databricks">permissions or other configuration issues</a> before running the crawler, click <strong>Preflight checks</strong>. This isÂ currently only supported when using REST API and offline extraction methods. If you&#x27;re using system tables, skip to step 2.</li>
<li>You can either:<!-- -->
<ul>
<li>To run the crawler once immediately, at the bottom of the screen, click the <strong>Run</strong> button.</li>
<li>To schedule the crawler to run hourly, daily, weekly, or monthly, at the bottom of the screen, click the <strong>Schedule Run</strong> button.</li>
</ul>
</li>
</ol>
<p>Once the extractor has completed running, you will see lineage for Databricks assets! ð</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/connectors">connectors</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/data">data</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/crawl">crawl</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/api">api</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/authentication">authentication</a></li></ul></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/apps/connectors/data-warehouses/databricks/how-tos/set-up-an-azure-private-network-link-to-databricks"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Set up an Azure private network link to Databricks</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/apps/connectors/data-warehouses/databricks/how-tos/extract-on-premises-databricks-lineage"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">How to extract on-premises Databricks lineage</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#select-the-extractor" class="table-of-contents__link toc-highlight">Select the extractor</a></li><li><a href="#configure-the-lineage-extractor" class="table-of-contents__link toc-highlight">Configure the lineage extractor</a></li><li><a href="#optional-configure-the-usage-extractor" class="table-of-contents__link toc-highlight">(Optional) Configure the usage extractor</a></li><li><a href="#run-the-extractor" class="table-of-contents__link toc-highlight">Run the extractor</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 Atlan Pte. Ltd.</div></div></div></footer><span class="badge_WFAO badge_primary_SeIF" style="cursor:default"></span></div>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97e1fb59b98c7e78',t:'MTc1NzcwNzEyOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>